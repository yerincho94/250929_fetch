<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>API Key</title>
  </head>
  <body>
    <form id="subwayForm">
      <!-- 호선 이름을 option -->
      <select name="routeName">
        <option value="1호선">1호선</option>
        <option value="2호선">2호선</option>
        <option value="3호선">3호선</option>
        <option value="4호선">4호선</option>
      </select>
      <!-- 역 이름 text -->
      <input type="text" name="stationName" />
      <!-- 날짜 text -->
      <input name="date" placeholder="20250929 형식으로 입력하세요" />
      <button id="">조회</button>
    </form>

    <script>
      const subwayForm = document.querySelector("#subwayForm");
      subwayForm.addEventListener("submit", fetchSubway);

      async function fetchSubway(event) {
        const appKey = "5777776a4f7965723530476467634b";
        //const url = `http://openapi.seoul.go.kr:8088/${appKey}/json/CardSubwayStatsNew/1/5/20250922/9호선/김포공항`;
        event.preventDefault();

        const formData = new FormData(event.currentTarget);
        const date = formData.get("date");
        const routeName = formData.get("routeName");
        const stationName = formData.get("stationName");

        const url = `http://openapi.seoul.go.kr:8088/${appKey}/json/CardSubwayStatsNew/1/5/${date}/${routeName}/${stationName}`;

        const response = await fetch(url);
        const data = await response.json();
        console.log(data);
        console.log(data.CardSubwayStatsNew.row[0]);
        const stats = data.CardSubwayStatsNew.row[0];

        const stationOn = stats.GTON_TNOPE;
        const stationOff = stats.GTOFF_TNOPE;
        console.log(stationOn, stationOff);
      }
      //fetchSubway(); //await 못 붙임 (script -> async가 안붙어 있으니까..)
    </script>
  </body>
</html>
